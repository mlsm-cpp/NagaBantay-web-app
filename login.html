<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
<title>NagaBantay | Login</title>
</head>

<style>
* {
    box-sizing: border-box;
    font-family: 'Poppins', sans-serif;
}

body {
    margin: 0;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    background: #06402b;
    background-image: url("images/Mt. Isarog.jpg");
    background-repeat: no-repeat;
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
}

body::before {
    content: "";
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(6, 64, 43, 0.8); 
    z-index: -1;
}

.login-container {
    background: linear-gradient(225deg, #73a697, #8ebda9, #9fcab5, #def1e2, #ffffff);
    padding: 40px;
    width: 300px;
    border-radius: 10px;
    display: flex;
    flex-direction: column; 
    align-items: stretch; 
    text-align: left;     
}

.logo-header {
    display: flex;
    align-items: center; 
    justify-content: center;
    gap: 0px; 
    margin-bottom: 30px;
}

.logo {
    width: 30px;
    height: 30px;
    object-fit: contain;
}

.logo-header h2 {
    margin: 0;
    font-size: 24px;
    font-weight: 700;
}

.logo-header h2 .naga {
    color: #06402b;
}

.logo-header h2 .bantay {
    color: white;
    -webkit-text-stroke: 0.5px #06402b;
}

.input-container {
    position: relative;
    margin-bottom: 20px;
}

.input-container i {
    position: absolute;
    left: 10px;
    top: 50%;
    transform: translateY(-50%);
    color: #06402b;
    font-size: 16px;
    pointer-events: none;
}

.input-container input {
    width: 100%;
    padding: 12px 12px 12px 35px; /* space for icon */
    border-radius: 6px;
    border: 1px solid #ccc;
    box-sizing: border-box;
    font-weight: 500; 
}

.login-container button {
    width: 100%;
    padding: 12px;
    border: none;
    border-radius: 6px;
    background: #06402b;
    color: white;
    font-size: 16px;
    cursor: pointer;
    font-weight: 700;
}

.login-container button:hover {
    opacity: 0.9;
}

.error {
    color: red;
    font-size: 14px;
    display: none;
    margin-bottom: 10px;
}
</style>

<body>
 <div class="login-container">
        <div class="logo-header">
            <img src="images/logo.png" alt="Logo" class="logo">
            <h2><span class="naga">Naga</span><span class="bantay">Bantay</span></h2>
        </div>

        <form id="loginForm">
            <div class="input-container">
                <i class="fas fa-user"></i>
                <input type="email" id="email" placeholder="Email" required autofocus>
            </div>

            <div class="input-container">
                <i class="fas fa-lock"></i>
                <input type="password" id="password" placeholder="Password" required>
            </div>

            <div class="error" id="errorMsg" style="display:none;">Invalid login</div>

            <button type="submit">Login</button>
        </form>
</div>

<script type="module">
const form = document.getElementById("loginForm");
const errorMsg = document.getElementById("errorMsg");
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-auth.js";
import { getFirestore, collection, addDoc, getDocs, doc, setDoc } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore.js";

const firebaseConfig = {
    apiKey: "AIzaSyAVoghFOOiZwimjT48hG_Sp-GMLlhDgUAI",
    authDomain: "nagabantay.firebaseapp.com",
    projectId: "nagabantay",
    storageBucket: "nagabantay.firebasestorage.app",
    messagingSenderId: "92668872053",
    appId: "1:92668872053:web:a48bc62366aadb60dd7f3c"
  };

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

form.addEventListener("submit", async function (e) {
    e.preventDefault();

    const email = form.querySelector('#email').value; 
    const password = form.querySelector('#password').value;

    try {
        const userCredential = await signInWithEmailAndPassword(auth, email, password);
        const user = userCredential.user;

        const userDoc = await getDocs(collection(db, "users"));

        window.location.href = "home.html";

    } catch (error) {
        errorMsg.style.display = "block";
        console.error(error.code, error.message);
    }
});
</script>
</body>
</html>
